### 목표
1. 첫 번째 목표 - *파이썬으로 살펴보는 아키텍처 패턴* 내용을 따라가며 개발한다.
2. 두 번째 목표 - 여러 상황을 가정해본다. (사용자 동시 접근, 데이터베이스, 트래픽 등)
3. 세 번째 목표 - 프론트를 개발하고, 배포한다.


### 첫 번째 목표 -  파이썬으로 살펴보는 아키텍처 패턴

기능은 최소화하고, 책의 내용을 제대로 따라하고 숙지하는 것을 목표로 한다.

#### 기능
- 유저는 판매자와 구매자로 나눈다.
- 판매자는 판매 페이지에 상품을 등록한다.
- 상품 등록은 이름, 재고, 가격을 입력으로 받는다.
- 구매자는 상품을 구매한다.
- 상품 구매는 개수를 입력하여 구매한다.
- 재고가 구매하려는 개수보다 적으면 구매가 불가능하다.


### 개발일지

# 1. 도메인 서비스

처음에는 유저(구매자 판매자)를 기준으로 만들려고 했었다(Buyer.buy, Seller.register). 하지만 도메인 서비스라는 것은 도메인에 정의하는 행위를 말하는 것으로 내가 하려던 것들은 유저들의 UseCase로 구분하는 것이 맞는 것 같다. 그래서 도메인 모델도 유저를 제외하고, Product, Cart, Order를 생성했다.

찾아보니 도메인과 서비스를 구현하는 패턴들이 있었다. 트랜잭션 스크립트 -> 도메인 모델 -> 애그리거트 패턴 순으로 서비스에 대한 책임을 줄이고, 도메인 모델에 정의하거나, 애그리거트라는 개념을 사용해서 책임을 분산시킨다.

무엇보다 서비스라는 개념이 유즈 케이스로 이해하는 경우가 많아, 도메인 서비스로 따로 명명하기보다는 도메인의 행위라고 말하는 것이 좀 더 이해가 쉬울 것 같다.

1. 트랜잭션 스크립트 패턴

- 단순하게 도메인은 어떠한 행위도 하지 않고, 서비스가 모든 로직을 담당한다.

2. 도메인 모델 패턴

- **중요) 도메인 객체가 소유한 데이터는 도메인 객체가 제공하는 행위에 은닉시킨다.** 나는 단순히 도메인에 관련된 행위면 도메인 모델에 구현해야 하는가? 고민이 있었다. 하지만 명확하게 책임의 범위가 주어져 있었다.

3. 애그리거트 패턴
- 도메인 모델을 진화시킨 버전이다. 도메인 모델링을 하다 보면 객체 간의 참조 관계가 생기고, 이러한 상황들에 의해 도메인 모델이 커짐에 따라 데이터를 처리함에 있어 복잡해지고 꼬일 수 있다. 예를 들어 일대다(one-to-many) 참조 관계가 있는 모델에서 다(many)측의 데이터를 수정하면, 일(one)측의 데이터를 다시 집계하지 않는다면, 비즈니스 일관성이 깨질 것이다.
- 그래서 이러한 도메인 모델 간의 관계를 최상위에 존재하는 엔티티를 중심으로 개념의 집합울 분리한 것이 애그리거트 패턴이다.
- 애그리거트를 일관되게 처리하기 위해 다음과 같은 규칙을 부여한다.
	1. 애그리거트 루트만 참조한다.
	2. 애그리거트 내 상세 클래스를 바로 참조하지 않고 루트를 통해 참조해야 한다. 수정할 때도 마찬가지다.
	3. 애그리거트 간의 참조는 객체를 직접 참조하는 대신 기본 키를 사용한다. 기본 키를 사용하면 느슨하게 연관되고 수정이 필요하지 않은 애그리거트를 함께 수정하는 실수를 방지한다.
	4. 하나의 트랜잭션으로 하나의 애그리거트만 생성 및 수정한다.

자꾸 구현부터 하려는 습관이 나와서 전체적인 설계를 먼저 그리고 다시 시작해야겠다.